angular.module("app",["ngRoute","routeModule","serviceModule","commonBarModule","comingSoonModule","in_theatersModule","searchModule"]),angular.module("commonBarModule",[]).controller("navBarCtrl",["$scope","$location",function(o,e){o.isActive="in_theaters",o.search=function(){e.path("/search/"+o.keyword+"/1")}}]),angular.module("routeModule",[]).config(["$routeProvider",function(o){o.when("/in_theaters/:page",{templateUrl:"./views/in_theaters/in_theaters.html",controller:"in_theatersCtrl"}).when("/coming_soon/:page",{templateUrl:"./views/coming_soon/comingSoon.html",controller:"coming_soonCtrl"}).when("/search/:keyword/:page",{templateUrl:"./views/search/search.html",controller:"searchCtrl"}).otherwise("/in_theaters/1")}]),angular.module("serviceModule",[]).service("myService",[function(){this.url="https://api.douban.com",this.Jsonp=function(o,e,t){var n="Jsonp"+Math.random().toString().replace(".","");window[n]=t;var a="";for(var r in e)a+=r+"="+e[r]+"&";var c=document.createElement("script");c.src=o+"?"+a+"callback="+n,document.body.appendChild(c),c.onload=function(){document.body.removeChild(c)}}}]),angular.module("in_theatersModule",[]).controller("in_theatersCtrl",["$scope","$http","myService","$routeParams","$location",function(o,e,t,n,a){var r=t.url+"/v2/movie/in_theaters",c=n.page,l=10*(c-1),i=0;t.Jsonp(r,{start:l,count:10},function(e){console.log(e),o.data=e,o.$apply(),i=Math.ceil(e.total/e.count)}),o.changePage=function(o){"prev"==o?--c<1&&(c=1):"next"==o&&++c>i&&(c=i),a.path("/in_theaters/"+c)}}]),angular.module("searchModule",[]).controller("searchCtrl",["$scope","$http","myService","$routeParams","$location",function(o,e,t,n,a){var r=t.url+"/v2/movie/search",c=n.keyword,l=n.page,i=10*(l-1),u=0;t.Jsonp(r,{q:c,start:i,count:10},function(e){console.log(e),o.data=e,o.$apply(),u=Math.ceil(e.total/e.count)}),o.changePage=function(o){"prev"==o?--l<1&&(l=1):"next"==o&&++l>u&&(l=u),a.path("/search/"+c+"/"+l)}}]),angular.module("comingSoonModule",[]).controller("coming_soonCtrl",["$scope","$http","myService","$routeParams","$location",function(o,e,t,n,a){var r=t.url+"/v2/movie/coming_soon",c=n.page,l=10*(c-1),i=0;t.Jsonp(r,{start:l,count:10},function(e){console.log(e),o.data=e,o.$apply(),i=Math.ceil(e.total/e.count)}),o.changePage=function(o){"prev"==o?--c<1&&(c=1):"next"==o&&++c>i&&(c=i),a.path("/coming_soon/"+c)}}]);